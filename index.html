<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="fonts.google.com/css?family=Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="see you again">
<meta property="og:type" content="website">
<meta property="og:title" content="歇斯底里 摧枯拉朽">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="歇斯底里 摧枯拉朽">
<meta property="og:description" content="see you again">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="歇斯底里 摧枯拉朽">
<meta name="twitter:description" content="see you again">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: 'YUZRY20OHA',
      apiKey: '33e77ba668ada417619c33faf69733d7',
      indexName: 'Tech_cnicetoupp',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title> 歇斯底里 摧枯拉朽 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">歇斯底里 摧枯拉朽</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">战士</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">  
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/28/2017-6-28-ThreadLocal的使用/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="超CniceToUpp">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpeg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="歇斯底里 摧枯拉朽">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="歇斯底里 摧枯拉朽" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/28/2017-6-28-ThreadLocal的使用/" itemprop="url">
                  ThreadLocal的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-28T14:37:07+08:00">
                2017-06-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java开发/" itemprop="url" rel="index">
                    <span itemprop="name">Java开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2017/06/28/2017-6-28-ThreadLocal的使用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/06/28/2017-6-28-ThreadLocal的使用/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="ThreadLocal是什么？"><a href="#ThreadLocal是什么？" class="headerlink" title="ThreadLocal是什么？"></a>ThreadLocal是什么？</h3><p>线程局部变量(ThreadLocal)其实的功用非常简单，就是为每一个使用该变量的线程都提供一个变量值的副本，是Java中一种较为特殊的线程绑定机制，是每一个线程都可以独立地改变自己的副本，而不会和其它线程的副本冲突</p>
<p>从线程的角度看，每个线程都保持一个对其线程局部变量副本的隐式引用，只要线程是活动的并且 ThreadLocal 实例是可访问的；在线程消失之后，其线程局部实例的所有副本都会被垃圾回收（除非存在对这些副本的其他引用）。</p>
<p>通过ThreadLocal存取的数据，总是与当前线程相关，也就是说，JVM 为每个运行的线程，绑定了私有的本地实例存取空间，从而为多线程环境常出现的并发访问问题提供了一种隔离机制。</p>
<p>概括起来说，<strong>对于多线程资源共享的问题，同步机制采用了“以时间换空间”的方式，而ThreadLocal采用了“以空间换时间”的方式。前者仅提供一份变量，让不同的线程排队访问，而后者为每一个线程都提供了一份变量，因此可以同时访问而互不影响。</strong></p>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><p>经典案例，也是常用的ThreadLocal使用方式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/** </span></div><div class="line"> * 数据库连接管理类 </div><div class="line"> * <span class="doctag">@author</span> 爽 </div><div class="line"> * </div><div class="line"> */  </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConnectionManager</span> </span>&#123;  </div><div class="line">  </div><div class="line">    <span class="comment">/** 线程内共享Connection，ThreadLocal通常是全局的，支持泛型 */</span>  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;Connection&gt; threadLocal = <span class="keyword">new</span> ThreadLocal&lt;Connection&gt;();  </div><div class="line">      </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getCurrConnection</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="comment">// 获取当前线程内共享的Connection  </span></div><div class="line">        Connection conn = threadLocal.get();  </div><div class="line">        <span class="keyword">try</span> &#123;  </div><div class="line">            <span class="comment">// 判断连接是否可用  </span></div><div class="line">            <span class="keyword">if</span>(conn == <span class="keyword">null</span> || conn.isClosed()) &#123;  </div><div class="line">                <span class="comment">// 创建新的Connection赋值给conn(略)  </span></div><div class="line">                <span class="comment">// 保存Connection  </span></div><div class="line">                threadLocal.set(conn);  </div><div class="line">            &#125;  </div><div class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;  </div><div class="line">            <span class="comment">// 异常处理  </span></div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">return</span> conn;  </div><div class="line">    &#125;  </div><div class="line">      </div><div class="line">    <span class="comment">/** </span></div><div class="line">     * 关闭当前数据库连接 </div><div class="line">     */  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="comment">// 获取当前线程内共享的Connection  </span></div><div class="line">        Connection conn = threadLocal.get();  </div><div class="line">        <span class="keyword">try</span> &#123;  </div><div class="line">            <span class="comment">// 判断是否已经关闭  </span></div><div class="line">            <span class="keyword">if</span>(conn != <span class="keyword">null</span> &amp;&amp; !conn.isClosed()) &#123;  </div><div class="line">                <span class="comment">// 关闭资源  </span></div><div class="line">                conn.close();  </div><div class="line">                <span class="comment">// 移除Connection  </span></div><div class="line">                threadLocal.remove();  </div><div class="line">                conn = <span class="keyword">null</span>;  </div><div class="line">            &#125;  </div><div class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;  </div><div class="line">            <span class="comment">// 异常处理  </span></div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样处理的好处：</p>
<p>统一管理Connection；<br>不需要显示传参Connection，代码更优雅；<br>降低耦合性。</p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>ThreadLocal是如何做到为每一个线程维护变量的副本的呢？<strong>其实实现的思路很简单，在ThreadLocal类中有一个Map，用于存储每一个线程的变量的副本</strong>。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li>ThreadLocal使用场合主要解决多线程中数据数据因并发产生不一致问题。ThreadLocal为每个线程的中并发访问的数据提供一个副本，通过访问副本来运行业务，这样的结果是耗费了内存，单大大减少了线程同步所带来性能消耗，也减少了线程并发控制的复杂度。</li>
</ul>
<ul>
<li>ThreadLocal不能使用原子类型，只能使用Object类型。ThreadLocal的使用比synchronized要简单得多。</li>
</ul>
<ul>
<li>ThreadLocal和Synchonized都用于解决多线程并发访问。但是ThreadLocal与synchronized有本质的区别。synchronized是利用锁的机制，使变量或代码块在某一时该只能被一个线程访问。而ThreadLocal为每一个线程都提供了变量的副本，使得每个线程在某一时间访问到的并不是同一个对象，这样就隔离了多个线程对数据的数据共享。而Synchronized却正好相反，它用于在多个线程间通信时能够获得数据共享。<strong>Synchronized用于线程间的数据共享，而ThreadLocal则用于线程间的数据隔离。</strong><br>当然ThreadLocal并不能替代synchronized,<strong>它们处理不同的问题域</strong>。Synchronized用于实现同步机制，比ThreadLocal更加复杂。</li>
</ul>
<ul>
<li>可以避免参数传递的访问方式</li>
</ul>
<h3 id="ThreadLocal使用的一般步骤"><a href="#ThreadLocal使用的一般步骤" class="headerlink" title="ThreadLocal使用的一般步骤"></a>ThreadLocal使用的一般步骤</h3><ol>
<li>在多线程的类（如ThreadDemo类）中，创建一个ThreadLocal对象threadXxx，用来保存线程间需要隔离处理的对象xxx。</li>
<li>在ThreadDemo类中，创建一个获取要隔离访问的数据的方法getXxx()，在方法中判断，若ThreadLocal对象为null时候，应该new()一个隔离访问类型的对象，并强制转换为要应用的类型。</li>
<li>在ThreadDemo类的run()方法中，通过getXxx()方法获取要操作的数据，这样可以保证每个线程对应一个数据对象，在任何时刻都操作的是这个对象。</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/28/2017-6-28-线程的生命周期/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="超CniceToUpp">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpeg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="歇斯底里 摧枯拉朽">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="歇斯底里 摧枯拉朽" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/28/2017-6-28-线程的生命周期/" itemprop="url">
                  线程的生命周期
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-28T14:37:07+08:00">
                2017-06-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java开发/" itemprop="url" rel="index">
                    <span itemprop="name">Java开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2017/06/28/2017-6-28-线程的生命周期/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/06/28/2017-6-28-线程的生命周期/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="线程的生命周期"><a href="#线程的生命周期" class="headerlink" title="线程的生命周期"></a>线程的生命周期</h1><p>线程的生命周期：一个线程从创建到消亡的过程。（包括同步时的状态变化）</p>
<p><img src="/resources/images/threadlifecycle.png" alt="image"></p>
<ol>
<li><p>创建状态（new）：当用new操作符创建一个新的线程对象时，该线程处于创建状态。处于创建状态的线程只是一个空的线程对象，系统不为它分配资源。</p>
</li>
<li><p>可运行状态（就绪状态Runable）：执行线程的start()方法将为线程分配必须的系统资源，安排其运行，并调用线程体——run()方法，这样就使得该线程处于可运行状态（Runnable）。<br>　　这一状态并不是运行中状态（Running），因为线程也许实际上并未真正运行
　　</p>
</li>
<li><p>运行状态（Running）：就绪状态的线程获取了CPU，执行程序代码</p>
</li>
<li><p>阻塞状态（Blocked）：阻塞状态是线程因为某种原因放弃CPU使用权，暂时停止运行。直到线程进入就绪状态，才有机会转到运行状态。阻塞的情况分三种：</p>
<ol>
<li>等待阻塞：运行的线程执行wait()方法，JVM会把该线程放入等待池中，待调用notify()/notifyAll()唤醒指定的线程或者所有线程，接着会进入锁池，竞争锁，再次获得对象锁才会进入运行状态</li>
<li>同步阻塞：运行的线程在获取对象的同步锁时，若该同步锁被别的线程占用，则JVM会把该线程放入锁池中。</li>
<li>其他阻塞：运行的线程执行sleep()或join()方法，或者发出了I/O请求时，JVM会把该线程置为阻塞状态。当sleep()状态超时、join()等待线程终止或者超时、或者I/O处理完毕时，线程重新转入就绪状态。</li>
</ol>
</li>
<li><p>死亡状态（Dead）：线程执行完了或者因异常退出了run()方法，该线程结束生命周期</p>
</li>
</ol>
<h2 id="speep（）和-wait-的区别"><a href="#speep（）和-wait-的区别" class="headerlink" title="speep（）和 wait()的区别"></a>speep（）和 wait()的区别</h2><ol>
<li>每个对象都有一个锁来控制同步访问，Synchronized关键字可以和对象的锁交互，来实现同步方法或同步块。<strong>sleep()方法</strong>正在执行的线程主动让出CPU（然后CPU就可以去执行其他任务），在sleep指定时间后CPU再回到该线程继续往下执行(<strong>注意：sleep方法只让出了CPU，而并不会释放同步资源锁，也就是不会释放同步资源！！！</strong>)；<strong>wait()方法</strong>则是指当前线程让自己暂时退让出同步资源锁，以便其他正在等待该资源的线程得到该资源进而运行，只有调用了notify()方法，之前调用wait()的线程才会解除wait状态，可以去参与竞争同步资源锁，进而得到执行。（注意：notify的作用相当于叫醒睡着的人，而并不会给他分配任务，就是说notify只是让之前调用wait的线程有权利重新参与线程的调度）；</li>
<li>sleep()方法可以在任何地方使用；wait()方法则只能在同步方法或同步块中使用；</li>
<li>sleep()是线程线程类（Thread）的方法，调用会暂停此线程指定的时间，但监控依然保持，不会释放对象锁，到时间自动恢复；wait()是Object的方法，调用会放弃对象锁，<strong>进入等待队列</strong>，待调用notify()/notifyAll()唤醒指定的线程或者所有线程，<strong>才会进入锁池</strong>，再次获得对象锁才会进入运行状态；<br>。</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/28/2017-6-28-线程池的使用/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="超CniceToUpp">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpeg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="歇斯底里 摧枯拉朽">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="歇斯底里 摧枯拉朽" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/28/2017-6-28-线程池的使用/" itemprop="url">
                  线程池的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-28T14:37:07+08:00">
                2017-06-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java开发/" itemprop="url" rel="index">
                    <span itemprop="name">Java开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2017/06/28/2017-6-28-线程池的使用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/06/28/2017-6-28-线程池的使用/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ThreadPoolExecutor"><a href="#ThreadPoolExecutor" class="headerlink" title="ThreadPoolExecutor"></a>ThreadPoolExecutor</h1><p>首先，我们应该明白了ThreadPoolExecutor、AbstractExecutorService、ExecutorService和Executor几个之间的关系了。</p>
<ul>
<li><p>Executor是一个顶层接口，在它里面只声明了一个方法execute(Runnable)，返回值为void，参数为Runnable类型，从字面意思可以理解，就是用来执行传进去的任务的；</p>
</li>
<li><p>然后ExecutorService接口继承了Executor接口，并声明了一些方法：submit、invokeAll、invokeAny以及shutDown等；</p>
</li>
<li>抽象类AbstractExecutorService实现了ExecutorService接口，基本实现了ExecutorService中声明的所有方法；</li>
<li>然后ThreadPoolExecutor继承了类AbstractExecutorService。</li>
</ul>
<p>　　在ThreadPoolExecutor类中有几个非常重要的方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">execute()</div><div class="line">submit()</div><div class="line">shutdown()</div><div class="line">shutdownNow()</div></pre></td></tr></table></figure>
<p> 　　execute()方法实际上是Executor中声明的方法，在ThreadPoolExecutor进行了具体的实现，这个方法是ThreadPoolExecutor的核心方法，通过这个方法可以向线程池提交一个任务，交由线程池去执行。</p>
<p>　　submit()方法是在ExecutorService中声明的方法，在AbstractExecutorService就已经有了具体的实现，在ThreadPoolExecutor中并没有对其进行重写，这个方法也是用来向线程池提交任务的，但是它和execute()方法不同，它能够返回任务执行的结果，去看submit()方法的实现，会发现它实际上还是调用的execute()方法，只不过它利用了Future来获取任务执行结果（Future相关内容将在下一篇讲述）。</p>
<p>　　shutdown()和shutdownNow()是用来关闭线程池的。<br>ThreadPoolExecutor是ExecutorService的一个实现类，它使用线程池中的线程执行每个提交的任务，我们平时的做法通常使用 Executors 工厂方法配置。</p>
<p><strong>线程池的作用：通常都在执行大量异步任务时避免频繁的创建线程和销毁线程。因为频繁的创建线程和销毁线程会给系统带来巨大的开销等</strong></p>
<p>每个 ThreadPoolExecutor 还维护着一些基本的统计数据，如完成的任务数。为了便于跨大量上下文使用，此类提供了很多可调整的参数和扩展钩子 (hook)。<br>但是，强烈建议程序员使用较为方便的 Executors 工厂方法。<br>Executors.newCachedThreadPool()（无界线程池，可以进行自动线程回收）、Executors.newFixedThreadPool(int)（固定大小线程池），Executors.newSingleThreadExecutor()（单个后台线程），<br>它们均为大多数使用场景预设置了一些参数。否则，在手动配置和调整此类时，使用以下指导。</p>
<p>首先我们来看下ThreadPoolExecutor类的构造方法有哪些参数?</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ThreadPoolExecutor</span><span class="params">(<span class="keyword">int</span> corePoolSize,</span></span></div><div class="line">                          <span class="keyword">int</span> maximumPoolSize,</div><div class="line">                          <span class="keyword">long</span> keepAliveTime,</div><div class="line">                          TimeUnit unit,</div><div class="line">                          BlockingQueue&lt;Runnable&gt; workQueue,</div><div class="line">                          ThreadFactory threadFactory,</div><div class="line">                          RejectedExecutionHandler handler) &#123;</div><div class="line">    <span class="keyword">if</span> (corePoolSize &lt; <span class="number">0</span> ||</div><div class="line">        maximumPoolSize &lt;= <span class="number">0</span> ||</div><div class="line">        maximumPoolSize &lt; corePoolSize ||</div><div class="line">        keepAliveTime &lt; <span class="number">0</span>)</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</div><div class="line">    <span class="keyword">if</span> (workQueue == <span class="keyword">null</span> || threadFactory == <span class="keyword">null</span> || handler == <span class="keyword">null</span>)</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</div><div class="line">    <span class="keyword">this</span>.corePoolSize = corePoolSize;</div><div class="line">    <span class="keyword">this</span>.maximumPoolSize = maximumPoolSize;</div><div class="line">    <span class="keyword">this</span>.workQueue = workQueue;</div><div class="line">    <span class="keyword">this</span>.keepAliveTime = unit.toNanos(keepAliveTime);</div><div class="line">    <span class="keyword">this</span>.threadFactory = threadFactory;</div><div class="line">    <span class="keyword">this</span>.handler = handler;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<pre><code>参数：

corePoolSize - 池中所运行的核心线程，包括忙碌线程和空闲线程。    
maximumPoolSize - 池中允许的最大线程数。        
keepAliveTime - 当线程数大于核心时，此为终止前多余的空闲线程等待新任务的最长时间。    
unit - keepAliveTime 参数的时间单位。        
workQueue - 执行前用于保持任务的队列。此队列仅由保持 execute 方法提交的 Runnable 任务。                                                
threadFactory - 执行程序创建新线程时使用的工厂。     
handler - 由于超出线程范围和队列容量而使执行被阻塞时所使用的处理程序。 
</code></pre></blockquote>
<h3 id="各参数之间的关系-corePoolSize，maximumPoolSize，workQueue"><a href="#各参数之间的关系-corePoolSize，maximumPoolSize，workQueue" class="headerlink" title="各参数之间的关系-corePoolSize，maximumPoolSize，workQueue"></a>各参数之间的关系-corePoolSize，maximumPoolSize，workQueue</h3><p>当新任务在方法 execute(java.lang.Runnable) 中提交时，</p>
<ol>
<li><strong>当运行的线程数少于corePoolSize核心线程数，则创建线程来处理任务，即使核心线程中有空闲的线程，也照样创建新的线程来处理任务。</strong></li>
<li><strong>当运行的线程数大于corePoolSize核心线程数而少于maximumPoolSize最大线程数，且任务队列未满时，将任务放入任务队列。</strong>    </li>
<li><strong>当运行的线程大于corePoolSize核心线程数，且任务队列已满</strong><br><strong>1.若运行的线程数小于最大线程数，创建线程。</strong><br><strong>2.若运行的线程数等于最大线程数，则抛出异常。（具体看拒绝接受任务章节）</strong></li>
</ol>
<p>如果将corePoolSize和maximumPoolSize的值相同，则创建了固定大小的线程。<br>如果将maximumPoolSize设置为基本的无界值（Integer.MAX_VALUE）,则允许池可以任务数量的并发任务。</p>
<blockquote>
<p>注意1：在大多数情况下，核心和最大池大小仅基于构造来设置，不过也可以使用 setCorePoolSize(int) 和 setMaximumPoolSize(int) 进行动态更改。<br>注意2：仅当第1情况和低第3-1情况才创建线程.<br>注意3：在新任务被提交时，如果运行的core线程少于corePoolSize，才创建新core线程。并不是一开始就创建corePoolSize个core线程。</p>
</blockquote>
<h3 id="按需创建线程"><a href="#按需创建线程" class="headerlink" title="按需创建线程"></a>按需创建线程</h3><p>核心线程最初只是在新任务到达时才被ThreadPoolExecutor创建和启动的，但是也可以手动调用方法 prestartCoreThread() 或 prestartAllCoreThreads()来的提前启动核心线程。</p>
<p>如果构造带有非空队列的池，这时则可能希望预先启动线程。</p>
<blockquote>
<p>注意1：核心线程即core线程，只有当前线程数小于等于corePoolSize时，这时的线程才叫核心线程。</p>
</blockquote>
<h3 id="创建新线程-threadFactory"><a href="#创建新线程-threadFactory" class="headerlink" title="创建新线程-threadFactory"></a>创建新线程-threadFactory</h3><p>如果没有另外说明，则使用 Executors.defaultThreadFactory() 创建线程，他们在同一个ThreadGroup中并且这些线程具有相同的 NORM_PRIORITY 优先级和非守护进程状态。</p>
<p>如果通过参数(ThreadFactory threadFactory)传递进来，则使用实现了ThreadFactory接口的类来创建新线程</p>
<p>如果从 newThread 返回 null 时 ThreadFactory 未能创建线程，则执行程序将继续运行，但可能不执行任何任务。</p>
<blockquote>
<p>注意1:可以指定创建线程的ThreadFactory，默认的是使用Executors.defaultThreadFactory()来创建线程，所有的线程都在一个ThreadGroup中</p>
</blockquote>
<h3 id="存活时间-keepAliveTime"><a href="#存活时间-keepAliveTime" class="headerlink" title="存活时间-keepAliveTime"></a>存活时间-keepAliveTime</h3><p><strong>如果池中当前有多于corePoolSize 的线程，则这些多出的线程在空闲时间超过 keepAliveTime 时将会终止。</strong>这提供了当池处于非活动状态时减少资源消耗的方法。如果池后来变得更为活动，则可以创建新的线程。也可以使用方法 setKeepAliveTime(long, java.util.concurrent.TimeUnit) 动态地更改此参数。</p>
<blockquote>
<p>注意1：如果把值设为Long.MAX_VALUE TimeUnit.NANOSECONDS 的话，空闲线程不会被回收直到ThreadPoolExecutor为Terminate。<br>注意2：默认情况下，保持活动策略只在有多于corePoolSizeThreads 的线程时应用。<br>注意3：只要 keepAliveTime 值非 0，并且把allowCoreThreadTimeOut设为true，也可将此超时策略应用于核心线程。</p>
</blockquote>
<h3 id="任务队列-workQueue"><a href="#任务队列-workQueue" class="headerlink" title="任务队列-workQueue"></a>任务队列-workQueue</h3><p>所有 BlockingQueue 都可用于传输和存储提交的任务。可以使用此队列与corePoolSize和maximumPoolSize进行交互：</p>
<p>和《各参数之间的关系-corePoolSize，maximumPoolSize，workQueue》中讲的是同一个意思。这里再讲一次加深印象。</p>
<ul>
<li>如果运行的线程少于 corePoolSize，则 Executor 始终首选添加新的线程，而不进行排队。</li>
<li>如果运行的线程等于或多于 corePoolSize，则 Executor 始终首选将任务加入队列，而不创建新的线程。</li>
<li>如果队列已满，则无法将任务加入队列，则创建新的线程，除非创建此线程超出 maximumPoolSize，在这种情况下，任务将被拒绝。</li>
</ul>
<p>排队有三种策略：</p>
<ol>
<li><p>直接切换。（例如：SynchronousQueue）<br>工作队列默认是synchronousQueue，它将任务转手给没有其他任务持有的线程,在此，如果存在一个可立即运行任务的线程时，则加入队列，但是立即被可立即运行任务的线程给拿去运行，如果没有可立即运行任务的线程时，则试图把任务加入队列，此操作将会失败，因此会创建一个线程来运行任务。此策略可以避免在处理可能具有内部依赖性的任务集时出现死锁的现象。直接切换策略通常要求maximumPoolSizes是无界的，以防止拒绝新提交的任务,反过来说，当任务持续到达的速度比线程池通常任务处理的速度更快时，线程则可能无边界的增长。</p>
</li>
<li><p>无界队列（例如：LinkedBlockingQueue）<br>无界队列使用的队列是无特定容量的，例如LinkedBlockingQueue，无界队列将会导致在所有的核心线程都在忙碌时，新任务在都会在队列的等待。因此，所有创建的线程不会超过corePoolSize核心线程数。这样的话maximumPoolSize最大线程数的值也就是无效的。<br>当每个任务完全独立于其他任务，即任务执行互不影响时，则适合使用无界队列；例如网页服务器。<br>然而这种排队方式对于解决短暂爆发的任务处理是有用的。当任务持续到达线程池的速度大于线程池通常任务处理的速度平均数时，任务队列将可能无边界的增长。</p>
</li>
<li><p>有界队列（例如：ArrayBlockingQueue）<br>当使用一个有界的maximumPoolSizes最大线程数时，有界队列能够防止资源消耗殆尽。但是它更难去控制。<br>这就要权衡队列大小和最大线程数的大小了：<br>1.使用大型队列和小型池的话，将会降低CPU使用率，减少操作系统资源的使用和减少任务上下文切换的开销，但是会人为地导致低吞吐量。如果任务频繁地阻塞，其他任务等待时间也会变的更长。<br>2.使用小型队列和大型池，CPU使用率将会增加，同时因为大量任务在CPU上来回调度，就可能遇到不可接受的任务调度开销，也会降低吞吐量。</p>
</li>
</ol>
<h3 id="拒绝任务-RejectedExecutionHandler-handler"><a href="#拒绝任务-RejectedExecutionHandler-handler" class="headerlink" title="拒绝任务-(RejectedExecutionHandler)handler"></a>拒绝任务-(RejectedExecutionHandler)handler</h3><ol>
<li>当ThreadPoolExecutor对象调用了shutdown()或者shutdownNow()，即线程池关闭的时，</li>
<li>当线程池使用的是无界的最大线程数maximumPoolSize和无界的任务队列，并且队列已经满了的时<br>以下两种情况，将会导致线程池拒绝执行任务，在ThreadPoolExecutor类中的execute方法调用RejectedExecutionHandler接口中的rejectedExecution方法。</li>
</ol>
<p>下面提供了四种预定义的处理策略</p>
<ol>
<li>默认的使用ThreadPoolExecutor.AbortPolicy，这种处理是一旦拒绝接接受，丢弃任务，将会抛出一个runtime的异常。</li>
<li>ThreadPoolExecutor.CallerRunsPolicy，由调用executor方法自己的线程运行任务。这提供了一个简单的反馈控制机制，可以减慢新任务提交的速度。</li>
<li>ThreadPoolExecutor.DiscardPolicy，也是丢弃任务，但是不抛出异常。</li>
<li>ThreadPoolExecutor.DiscardPolicy：如果executor还没有shutdown，则处在任务队列头的任务将丢弃，则重新尝试执行任务（如果再次失败，继续重复此过程）</li>
</ol>
<blockquote>
<p>注意1:AbortPolicy，CallerRunsPolicy，DiscardPolicy和DiscardOldestPolicy都是rejectedExecution接口的一种实现。当然也可以自己定义个rejectedExecution实现。</p>
</blockquote>
<h3 id="钩子方法-hook-method"><a href="#钩子方法-hook-method" class="headerlink" title="钩子方法-hook method"></a>钩子方法-hook method</h3><p>ThreadPoolExecutor提供了可重写的beforeExecute和afterExecute方法，这两种方法分别在执行每个任务之前和之后调用。它们可用于操纵执行环境；例如，重新初始化ThreadLocal变量、搜集统计信息或添加日志条目。此外，还可以重写方法 terminated() 来执行 Executor 完全终止后需要完成的所有特殊处理。</p>
<p>如果钩子方法 (hook) 或回调方法抛出异常，则ThreadPoolExecutor的所有线程将依次失败并突然终止。</p>
<h3 id="队列维护"><a href="#队列维护" class="headerlink" title="队列维护"></a>队列维护</h3><p>ThreadPoolExecutor提供了多个方法，去维护队列。</p>
<p>getQueue() -方法 getQueue() 允许出于监控和调试目的而访问工作队列。强烈反对出于其他任何目的而使用此方法。</p>
<p>remove(java.lang.Runnable) - 从队列中移除已存在的任务，这将会导致该任务还没开始就不会去运行。</p>
<p>purge() -可用于通过清空大量已排队，但是却已被取消的任务时，以帮助线程池进行存储回收。</p>
<p>remove(java.lang.Runnable) 和 purge() 这两种方法可用于通过取消大量已排队但是已被取消的任务时，以帮助进行存储空间回收。</p>
<blockquote>
<p>注意1:如果任务取消，ThreadPoolExecutor应该自己是可以进行存储回收的。取消的任务不会再次执行，但是它们可能在工作队列中累积，直到worker线程主动将其移除,外部使用remove()和purge()可以把它们立即从队列中移除。</p>
</blockquote>
<h3 id="线程池的关闭"><a href="#线程池的关闭" class="headerlink" title="线程池的关闭"></a>线程池的关闭</h3><p>ThreadPoolExecutor提供了两个方法，用于线程池的关闭，分别是<strong>shutdown()</strong>和<strong>shutdownNow()</strong>，其中：</p>
<p>shutdown()：不会立即终止线程池，而是要等所有任务缓存队列中的任务都执行完后才终止，但再也不会接受新的任务<br>shutdownNow()：立即终止线程池，并尝试打断正在执行的任务，并且清空任务缓存队列，返回尚未执行的任务</p>
<h3 id="我们来看下Eecutors中工厂方法的配置"><a href="#我们来看下Eecutors中工厂方法的配置" class="headerlink" title="我们来看下Eecutors中工厂方法的配置"></a>我们来看下Eecutors中工厂方法的配置</h3><ol>
<li>Eecutors.newFixedThreadPool(n)</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newFixedThreadPool</span><span class="params">(<span class="keyword">int</span> nThreads)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(nThreads, nThreads,</div><div class="line">                                  <span class="number">0L</span>, TimeUnit.MILLISECONDS,</div><div class="line">                                  <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>该工厂方法创建了一个固定大小为nThreads的任务队列，无界的任务队列的线程池，如果不设置allowCoreThreadTimeOut设为true，keepalivetime无意义，如果allowCoreThreadTimeOut设为true，则核心线程中一旦有空闲的线程，就会被销毁掉。</p>
<ol>
<li>Eecutors.newSingleThreadExecutor()</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newSingleThreadExecutor</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> FinalizableDelegatedExecutorService</div><div class="line">        (<span class="keyword">new</span> ThreadPoolExecutor(<span class="number">1</span>, <span class="number">1</span>,</div><div class="line">                                <span class="number">0L</span>, TimeUnit.MILLISECONDS,</div><div class="line">                                <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;()));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>该工厂方法创建了一个固定大小为1的任务队列，无界的任务队列的线程池，如果不设置allowCoreThreadTimeOut设为true，keepalivetime无意义，如果allowCoreThreadTimeOut设为true，则核心线程中一旦有空闲的线程，就会被销毁掉。</p>
<ol>
<li>Eecutors.newCachedThreadPool()</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newCachedThreadPool</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">0</span>, Integer.MAX_VALUE,</div><div class="line">                                  <span class="number">60L</span>, TimeUnit.SECONDS,</div><div class="line">                                  <span class="keyword">new</span> SynchronousQueue&lt;Runnable&gt;());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>该工厂方法创建了一个无界线程池，并且可以进行自动线程回收。keepalivetime是60，即表示，空闲线程空闲时间达到60秒则进行回收。              </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/25/hexo建站时遇到的坑/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="超CniceToUpp">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpeg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="歇斯底里 摧枯拉朽">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="歇斯底里 摧枯拉朽" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/25/hexo建站时遇到的坑/" itemprop="url">
                  hexo建站时遇到的坑
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-25T19:34:34+08:00">
                2016-12-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/博客/" itemprop="url" rel="index">
                    <span itemprop="name">博客</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/12/25/hexo建站时遇到的坑/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/12/25/hexo建站时遇到的坑/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第一个坑：设置网站头像"><a href="#第一个坑：设置网站头像" class="headerlink" title="第一个坑：设置网站头像"></a>第一个坑：设置网站头像</h1><p>编辑 <code>站点配置文件</code>， 新增字段 avatar， 值设置成头像的链接地址。其中，头像的链接地址可以是：</p>
<ul>
<li>完整的互联网 URI    <a href="http://example.com/avtar.png" target="_blank" rel="external">http://example.com/avtar.png</a></li>
<li>站点内的地址    <ul>
<li>头像放置<code>站点目录</code>下的 source/uploads/ 目录下（新建uploads目录若不存在）<br>  配置为：avatar: /uploads/avatar.png</li>
<li>头像放置<code>主题目录</code>下的 source/images/ 目录下<br>  配置为：avatar: /images/avatar.png</li>
</ul>
</li>
</ul>
<h1 id="可修改页面中各个插件的配色"><a href="#可修改页面中各个插件的配色" class="headerlink" title="可修改页面中各个插件的配色"></a>可修改页面中各个插件的配色</h1><p><strong>修改代码块的各个颜色</strong></p>
<p><code>/themes/next/source/css/_common/components/highlight</code></p>
<p>可以通过修改上述目录下的<code>theme.styl</code>文件和<code>highlight.styl</code>文件的颜色参数值，就可以修改代码块的背景色，前景色，注释的颜色等等。</p>
<p>显示效果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">int a = 0;</div></pre></td></tr></table></figure>
<p><strong>修改引用块的各个颜色</strong></p>
<p><code>/themes/next/source/css/_common/scaffolding</code></p>
<p><code>/themes/next/source/css/_variables/base.styl</code></p>
<p>可以通过修改上述目录下的<code>base.styl</code>文件的颜色参数值，就可以修改block quote的border-left等等颜色。</p>
<blockquote>
<p>Email-style angle brackets<br>are used for blockquotes.</p>
<blockquote>
<p>And, they can be nested.</p>
</blockquote>
<h4 id="Headers-in-blockquotes"><a href="#Headers-in-blockquotes" class="headerlink" title="Headers in blockquotes"></a>Headers in blockquotes</h4><ul>
<li>You can quote a list.</li>
<li>Etc.</li>
</ul>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/25/Hexo主题之Algolia搜索集成/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="超CniceToUpp">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpeg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="歇斯底里 摧枯拉朽">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="歇斯底里 摧枯拉朽" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/25/Hexo主题之Algolia搜索集成/" itemprop="url">
                  Hexo主题之Algolia搜索集成
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-25T14:37:07+08:00">
                2016-12-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/博客/" itemprop="url" rel="index">
                    <span itemprop="name">博客</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/12/25/Hexo主题之Algolia搜索集成/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/12/25/Hexo主题之Algolia搜索集成/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="注册Algolia-创建Index"><a href="#注册Algolia-创建Index" class="headerlink" title="注册Algolia,创建Index"></a>注册Algolia,创建Index</h1><p>前往 <a href="https://www.algolia.com/" target="_blank" rel="external">Algolia 注册页面</a>，注册一个新账户。 可以使用 GitHub 或者 Google 账户直接登录，注册后的 14 天内拥有所有功能（包括收费类别的）。之后若未续费会自动降级为免费账户，免费账户 总共有 10,000 条记录，每月有 100,000 的可以操作数。注册完成后，创建一个新的 Index，这个 Index 将在后面使用。</p>
<h1 id="安装Hexo-Algol插件"><a href="#安装Hexo-Algol插件" class="headerlink" title="安装Hexo Algol插件"></a>安装Hexo Algol插件</h1><p>Index 创建完成后，此时这个 Index 里未包含任何数据。 接下来需要安装 Hexo Algolia 扩展， 这个扩展的功能是搜集站点的内容并通过 API 发送给 Algolia。前往站点根目录，执行命令安装：</p>
<p><code>npm install --save hexo-algolia</code></p>
<h1 id="获取-Key-更新站点配置"><a href="#获取-Key-更新站点配置" class="headerlink" title="获取 Key,更新站点配置"></a>获取 Key,更新站点配置</h1><p>在 Algolia 服务站点上找到需要使用的一些配置的值，包括 ApplicationID、Search API Key、 Admin API Key。注意，Admin API Key 需要保密保存。</p>
<img src="/resources/images/Algolia_API_key.png" width="400" height="400" title="Algolia_Key_API">
<p>编辑<code>站点配置文件</code>，新增以下配置：</p>
<pre><code>algolia:
  applicationID: &apos;applicationID&apos;
  apiKey: &apos;apiKey&apos;
  adminApiKey: &apos;adminApiKey&apos;
  indexName: &apos;indexName&apos;
  chunkSize: 5000
  fields:
    - title
    - slug
    - path
    - content:strip
</code></pre><p>替换除了 chunkSize 和 fields 以外的其他字段为在 Algolia 获取到的值。field 代表所搜索的范围。</p>
<h1 id="更新Index"><a href="#更新Index" class="headerlink" title="更新Index"></a>更新Index</h1><p>当配置完成，在站点根目录下执行 <code>hexo algolia</code> 来更新 Index。注意：在执行<code>hexo algolia</code>命令之前先执行<code>hexo clean</code>，以避免algolia index 没有获取到最新的文章信息。请注意观察命令的输出。</p>
<img src="/resources/images/algolia_command.png" width="400" height="400" title="执行hexo algolia命令">
<h1 id="更新主题配置"><a href="#更新主题配置" class="headerlink" title="更新主题配置"></a>更新主题配置</h1><img src="/resources/images/themeConfig_algolia_search.png" width="400" height="400" title="algolia search主题配置">
<p>将 enable 改为 true 即可，根据需要你可以调整 labels 中的文本。</p>
<h1 id="其他注意点"><a href="#其他注意点" class="headerlink" title="其他注意点"></a>其他注意点</h1><h2 id="注意一"><a href="#注意一" class="headerlink" title="注意一"></a>注意一</h2><p>在themes\next\layout_partials中找到header.swig，找到以下代码并修改</p>
<figure class="highlight plain"><figcaption><span>header.swig </span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&#123;% if hasSearch %&#125;</div><div class="line">&lt;li class=&quot;menu-item menu-item-search&quot;&gt;</div><div class="line">    &#123;% if theme.swiftype_key %&#125;</div><div class="line">    &lt;a href=&quot;javascript:;&quot; class=&quot;st-search-show-outputs&quot;&gt;</div><div class="line">    &#123;% elseif config.search %&#125;</div><div class="line">    &lt;a href=&quot;javascript:;&quot; class=&quot;popup-trigger&quot;&gt;</div><div class="line">    &lt;!-- 添加 开始 --&gt;</div><div class="line">    &#123;% elseif theme.algolia %&#125;</div><div class="line">    &lt;a href=&quot;javascript:;&quot; class=&quot;popup-trigger&quot;&gt;</div><div class="line">    &lt;!-- 添加 结束 --&gt;</div><div class="line">    &#123;% endif %&#125;</div><div class="line">    &#123;% if theme.menu_icons.enable %&#125;</div><div class="line">        &lt;i class=&quot;menu-item-icon fa fa-search fa-fw&quot;&gt;&lt;/i&gt; &lt;br /&gt;</div><div class="line">    &#123;% endif %&#125;</div><div class="line">    &#123;&#123; __(&apos;menu.search&apos;) &#125;&#125;</div><div class="line">    &lt;/a&gt;</div><div class="line">&lt;/li&gt;</div><div class="line">&#123;% endif %&#125;</div></pre></td></tr></table></figure>
<h2 id="注意二"><a href="#注意二" class="headerlink" title="注意二"></a>注意二</h2><p>执行了上述所有操作，就可以看见搜索按钮了，不过点击搜索结果，会报 <code>can&#39;t find source</code>。</p>
<p>此时，我们需要修改两个地方</p>
<ul>
<li>請install npm install hexo-algolia@0.2.0， 然後在站点找到package.json， 把裏面的hexo-algolia， 換成 “hexo-algolia”: “^0.2.0”</li>
<li><p>去node_modules/hexo-algolia/lib， 找到command.js，加<code>&#39;path&#39;</code>。</p>
<pre><code>var storedPost = _.pick(data, [&apos;title&apos;, &apos;date&apos;, &apos;slug&apos;, &apos;path&apos;, &apos;content&apos;, &apos;excerpt&apos;, &apos;objectID’]);
</code></pre></li>
</ul>
<h2 id="注意三"><a href="#注意三" class="headerlink" title="注意三"></a>注意三</h2><p>hero版本要求5.0.1版本的</p>
<h1 id="成果"><a href="#成果" class="headerlink" title="成果"></a>成果</h1><p>点击search 出现在的algolia search界面</p>
<img src="/resources/images/search.png" width="400" height="400" title="algolia search">
<p>点击搜索结果，也会有效果，这里就不做展示了。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/16/Next主题配置/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="超CniceToUpp">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpeg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="歇斯底里 摧枯拉朽">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="歇斯底里 摧枯拉朽" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/16/Next主题配置/" itemprop="url">
                  Next主题配置
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-16T21:33:41+08:00">
                2016-12-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/博客/" itemprop="url" rel="index">
                    <span itemprop="name">博客</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/12/16/Next主题配置/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/12/16/Next主题配置/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/15/写作相关(1)-Hexo标签插件的使用/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="超CniceToUpp">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpeg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="歇斯底里 摧枯拉朽">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="歇斯底里 摧枯拉朽" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/15/写作相关(1)-Hexo标签插件的使用/" itemprop="url">
                  写作相关(1)-Hexo标签插件的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-15T20:01:27+08:00">
                2016-12-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/博客/" itemprop="url" rel="index">
                    <span itemprop="name">博客</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/12/15/写作相关(1)-Hexo标签插件的使用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/12/15/写作相关(1)-Hexo标签插件的使用/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="引用块"><a href="#引用块" class="headerlink" title="引用块"></a>引用块</h1><p>在文章中插入引言，可以包含作者，来源和标题</p>
<p>格式如下：(官方的文档，我都不想吐槽了)</p>
<pre><code>{% blockquote [source],[auhor] [link] [source_lik_title] %}
       content
{% endblockquote %}

source代表引用块的来源，例如：《人性的弱点》
author代表引用块的作者 例如：卡耐斯基
link代表引用快的链接 例如：www.rxdrd.com
source_link_title代表地引用块的链接标题 例如：人性的弱点
</code></pre><p>样例：</p>
<p><strong>引用书上的句子</strong></p>
<p>格式：</p>
<pre><code>{% blockquote [source],[author] %}
    content
{% endblockquote %}
</code></pre><p>显示效果：</p>
<pre><code>{% blockquote Wide Awake, David Levithan %}
    Do not just seek happiness for yourself. Seek happiness for all. Through kindness. Through mercy.
{% endblockquote %}
</code></pre><blockquote><p>Do not just seek happiness for yourself. Seek           happiness for all. Through kindness. Through mercy.</p>
<footer><strong>Wide Awake</strong><cite>David Levithan</cite></footer></blockquote>
<p><strong>引用网络上的文章</strong></p>
<p>格式：</p>
<pre><code>{% blockquote [source],[author] [link] [source_link_title]  %}
    content
{% endblockquote %}
</code></pre><p>显示效果：</p>
<pre><code>{% blockquote Seth Godin,hechao http://sethgodin.typepad.com/seths_blog/2009/07/welcome-to-island-marketing.html Welcome to Island Marketing %}
    Every interaction is both precious and an opportunity to delight.
{% endblockquote %}

source为Seth Godin
</code></pre><blockquote><p>Every interaction is both precious and an opportunity to delight.</p>
<footer><strong>Seth Godin,hechao</strong><cite><a href="http://sethgodin.typepad.com/seths_blog/2009/07/welcome-to-island-marketing.html" target="_blank" rel="external">Welcome to Island Marketing</a></cite></footer></blockquote>
<h1 id="代码块"><a href="#代码块" class="headerlink" title="代码块"></a>代码块</h1><p>有三种方式去实现在文章中插入代码块，效果一样，随自己心情取一种。第三种有个不好的地方是，在代码的最右上方不能指定文字和对应的url</p>
<h2 id="第一种格式"><a href="#第一种格式" class="headerlink" title="第一种格式"></a>第一种格式</h2><p>格式：</p>
<pre><code>{% codeblock [title] [lang:language] [url] [link text] %}

    code snippet

{% endcodeblock %}
</code></pre><p>显示效果：</p>
<pre><code>{% codeblock objective-C lang:objc https://github.com/rs/SDWebImage/blob/master/Examples/SDWebImage%20Demo/AppDelegate.m SDWebImage link %}
    code snippet
{% endcodeblock %}
</code></pre><figure class="highlight objc"><figcaption><span>objective-C</span><a href="https://github.com/rs/SDWebImage/blob/master/Examples/SDWebImage%20Demo/AppDelegate.m" target="_blank" rel="external">view source</a></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"> * file that was distributed with this source code.</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"AppDelegate.h"</span></span></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"MasterViewController.h"</span></span></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;SDWebImage/SDImageCache.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">AppDelegate</span></span></div><div class="line"></div><div class="line"><span class="keyword">@synthesize</span> window = _window;</div><div class="line"><span class="keyword">@synthesize</span> navigationController = _navigationController;</div><div class="line"></div><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions</div><div class="line">&#123;</div><div class="line">    <span class="comment">//Add a custom read-only cache path</span></div><div class="line">    <span class="built_in">NSString</span> *bundledPath = [[<span class="built_in">NSBundle</span> mainBundle].resourcePath stringByAppendingPathComponent:<span class="string">@"CustomPathImages"</span>];</div><div class="line">    [[SDImageCache sharedImageCache] addReadOnlyCachePath:bundledPath];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="第二种格式"><a href="#第二种格式" class="headerlink" title="第二种格式"></a>第二种格式</h2><p>反引号实现代码块</p>
<p>格式：</p>
<pre><code>因为三个反引号放在一起会启动代码解析异常，因此利用反斜杠转义反引号字符，所以一个 \` 代表了一个 `
\`\`\` [language] [title] [url] [link text] 

code snippet

\`\`\`
</code></pre><p>显示效果：</p>
<pre><code>\`\`\` objc objective-C https://github.com/rs/SDWebImage/blob/master/Examples/SDWebImage%20Demo/AppDelegate.m view source 

code snippet

\`\`\`
</code></pre><figure class="highlight objc"><figcaption><span>objective-C</span><a href="https://github.com/rs/SDWebImage/blob/master/Examples/SDWebImage%20Demo/AppDelegate.m" target="_blank" rel="external">view source </a></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"> * file that was distributed with this source code.</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"AppDelegate.h"</span></span></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"MasterViewController.h"</span></span></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;SDWebImage/SDImageCache.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">AppDelegate</span></span></div><div class="line"></div><div class="line"><span class="keyword">@synthesize</span> window = _window;</div><div class="line"><span class="keyword">@synthesize</span> navigationController = _navigationController;</div><div class="line"></div><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions</div><div class="line">&#123;</div><div class="line">    <span class="comment">//Add a custom read-only cache path</span></div><div class="line">    <span class="built_in">NSString</span> *bundledPath = [[<span class="built_in">NSBundle</span> mainBundle].resourcePath stringByAppendingPathComponent:<span class="string">@"CustomPathImages"</span>];</div><div class="line">    [[SDImageCache sharedImageCache] addReadOnlyCachePath:bundledPath];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="第三种格式-Include-Code"><a href="#第三种格式-Include-Code" class="headerlink" title="第三种格式 Include Code"></a>第三种格式 Include Code</h2><p>在文章中插入代码除了可以使用上面两种方式之外，还可以把整个文件作为代码插入，这样做的好处是作为可运行的代码后续如果修正了bug，重新hexo g一下文章中的代码就会自动更新；不需要每次从文件中拷贝粘贴代码到文章中。</p>
<h3 id="第一步：配置代码的存放路径"><a href="#第一步：配置代码的存放路径" class="headerlink" title="第一步：配置代码的存放路径"></a>第一步：配置代码的存放路径</h3><p>在hexo的配置文件/_config.yml中看到code_dir参数默认为<code>downloads/code</code>，我把它改成了<code>resources/code</code>,说明所有的code文件都必须存放到/source/resources/code文件夹下。若文件夹不存在，自行创建。</p>
<h3 id="第二步：在-md文章文件中书写"><a href="#第二步：在-md文章文件中书写" class="headerlink" title="第二步：在.md文章文件中书写"></a>第二步：在.md文章文件中书写</h3><p>格式：</p>
<pre><code>{% include_code [title] [lang:language] [filename] link linktitle  %}
[title]:可选，标题名，默认是文件名
[lang:language]:可选设置语言后，根据不同的语言设置语法高亮
[filename]： 代码文件名
</code></pre><p>显示效果：</p>
<p>EndianUtil.java 存放在 /source/resources/code 目录下</p>
<pre><code>{% include_code java lang:java EndianUtil.java %}
</code></pre><figure class="highlight java"><figcaption><span>java</span><a href="/resources/code/EndianUtil.java">view raw</a></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.microstrategy.dataservice.common;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.nio.ByteBuffer;</div><div class="line"><span class="keyword">import</span> java.nio.ByteOrder;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EndianUtil</span> </span>{</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] byteArrayToIntArray(<span class="keyword">byte</span>[] b, ByteOrder order)</div><div class="line">	{</div><div class="line">	    <span class="keyword">if</span> (b.length % <span class="number">4</span> != <span class="number">0</span>)</div><div class="line">	        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Invalid size of byte[] b"</span>);</div><div class="line">	    </div><div class="line">	    <span class="keyword">final</span> ByteBuffer bb = ByteBuffer.wrap(b);</div><div class="line">	    bb.order(order);</div><div class="line">	    </div><div class="line">	    <span class="keyword">int</span> size = b.length / <span class="number">4</span>;</div><div class="line">	    <span class="keyword">int</span>[] ia = <span class="keyword">new</span> <span class="keyword">int</span>[size];</div><div class="line">	    </div><div class="line">	    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)</div><div class="line">	    {</div><div class="line">	        ia[i] = bb.getInt();</div><div class="line">	    }        </div><div class="line">	    <span class="keyword">return</span> ia;</div><div class="line">	}</div><div class="line">}</div></pre></td></tr></table></figure>
<h1 id="iFrame"><a href="#iFrame" class="headerlink" title="iFrame"></a>iFrame</h1><p>使用iFrame可以插入网页，视频。</p>
<h2 id="插入网页"><a href="#插入网页" class="headerlink" title="插入网页"></a>插入网页</h2><p>格式：</p>
<pre><code>{% iframe url [width] [height] %}
</code></pre><p>显示效果：</p>
<pre><code>{% iframe https://github.com/ 700 400 %}
</code></pre><iframe src="https://github.com/" width="700" height="400" frameborder="0" allowfullscreen></iframe>
<iframe height="315" width="510" src="https://github.com/" frameborder="0" allowfullscreen></iframe>


<h2 id="插入视频"><a href="#插入视频" class="headerlink" title="插入视频"></a>插入视频</h2><p>除了使用iFrame插入视频，还可以使用Hexo自带的Youtube视频插件和Vimeo视频插件，下章节会讲到。</p>
<ul>
<li>优酷视频：在优酷视频网站，找到分享，复制通用代码，并且把代码中的单引号全部转化为双引号，即可。</li>
<li>youtube :在youtube网站，找到嵌入代码复制，即可。其他网站类似，我就不一一试了。</li>
<li>allowfullscreen参数：设置是否允许全屏。</li>
</ul>
<p>显示效果：<br>显示优酷的视频</p>
<pre><code>&lt;iframe height=&quot;315&quot; width=&quot;510&quot; src=&quot;http://player.youku.com/embed/XMTg1NDY0ODc1Mg==&quot; frameborder=0     allowfullscreen&gt;&lt;/iframe&gt;
</code></pre><iframe height="315" width="510" src="http://player.youku.com/embed/XMTg1NDY0ODc1Mg==" frameborder="0" allowfullscreen></iframe>

<p>显示youtube的视频</p>
<pre><code>&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/xgEa5tsdwYc&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;      
</code></pre><iframe width="560" height="315" src="https://www.youtube.com/embed/xgEa5tsdwYc" frameborder="0" allowfullscreen></iframe>




<h1 id="视频标签插件"><a href="#视频标签插件" class="headerlink" title="视频标签插件"></a>视频标签插件</h1><h2 id="Youtube视频标签插件"><a href="#Youtube视频标签插件" class="headerlink" title="Youtube视频标签插件"></a>Youtube视频标签插件</h2><p>在文章中Hexo自带插入<code>Youtube</code>视频的标签。</p>
<p>格式：</p>
<pre><code>{% youtube video_id %}
</code></pre><p>下图的红色下划线就是video_id</p>
<img src="/resources/images/youtubevIdeoID.png" width="196" height="50" title="video_id">
<p>显示效果：<div class="video-container"><iframe src="//www.youtube.com/embed/JwMKRevYa_M" frameborder="0" allowfullscreen></iframe></div></p>
<h2 id="Vimeo视频标签插件"><a href="#Vimeo视频标签插件" class="headerlink" title="Vimeo视频标签插件"></a>Vimeo视频标签插件</h2><p>在文章中Hexo自带插入<code>Vimeo</code>视频的标签。</p>
<p>格式：</p>
<pre><code>{% vimeo video_id %}

video_id意思同Youtube视频Id号一样
</code></pre><p>显示效果：<div class="video-container"><iframe src="//player.vimeo.com/video/193358188" frameborder="0" allowfullscreen></iframe></div></p>
<h1 id="插入图片"><a href="#插入图片" class="headerlink" title="插入图片"></a>插入图片</h1><h2 id="第一种-Hexo图片标签插件"><a href="#第一种-Hexo图片标签插件" class="headerlink" title="第一种 Hexo图片标签插件"></a>第一种 Hexo图片标签插件</h2><p>在文章中插入<code>指定大小</code>的图片。但是图片只会变大变小，并不会拉伸。</p>
<p>格式：</p>
<pre><code>{% img [class names] /path/to/image [width] [height] [title text] [alt text] %}

[class names] 代表 暂时不知道什么意思。暂时不填。

/path/to/image 代表 以/source文件夹为根路径的图片路径 ,例如/source/resource/tag.png是tag.png的所在路径，那么在这里只需要写上/resource/tag.png即可，不能写成/source/resource/tag.png。

[width] 代表图片宽度

[height] 代表图片高度

[title text] 代表图片标题 目前不清楚为啥出现两个title text。

[alt text] 代表图片副标题 目前不清楚为啥出现两个alt text。
</code></pre><p>显示效果：</p>
<ul>
<li><p>指定196*50的图片</p>
<pre><code>{% img /resources/images/google.png 196 50 googleImage %}
</code></pre>  <img src="/resources/images/google.png" width="196" height="50" title="googleImage">
</li>
</ul>
<ul>
<li><p>指定100*100的图片</p>
<pre><code>{% img /resources/images/google.png 100 100 googleImage %}
</code></pre>  <img src="/resources/images/google.png" width="100" height="100" title="googleImage">
</li>
</ul>
<h2 id="第二种-markdown默认的插入图片的格式"><a href="#第二种-markdown默认的插入图片的格式" class="headerlink" title="第二种 markdown默认的插入图片的格式"></a>第二种 markdown默认的插入图片的格式</h2><p>这是markdown默认的格式，不过填写图片路径时需要注意：</p>
<ul>
<li><p>本地路径 代表 以/source文件夹为根路径的图片路径，同方式一一样。</p>
<pre><code>![image](/resources/images/google.png)
</code></pre><p>  <img src="/resources/images/google.png" alt="image"></p>
</li>
</ul>
<ul>
<li><p>网络路径 代表 一个网络的url</p>
<pre><code>![image](https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_272x92dp.png)
</code></pre><p>  <img src="https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_272x92dp.png" alt="image"></p>
</li>
</ul>
<h2 id="第三种"><a href="#第三种" class="headerlink" title="第三种"></a>第三种</h2><p>使用方法在<code>文章资料文件夹</code> 的<code>获取图片资源</code>章节中</p>
<h1 id="文章资源文件夹"><a href="#文章资源文件夹" class="headerlink" title="文章资源文件夹"></a>文章资源文件夹</h1><p>管理文章资源非常方便</p>
<h2 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a>第一步</h2><p>可以通过将 config.yml 文件中的 post_asset_folder 选项设为 true 来打开Hexo的资源管理功能。</p>
<h2 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a>第二步</h2><p>打开之后，我们每次通过<code>hero new post postname</code> 命令的时候 会在<code>_post</code>目录下生成一个postname.md文章文件，和一个与文章文件同名的文件夹，里面可以存放该文章需要的资源，例如图片，pdf等等其他文件。</p>
<p><strong>获取图片资源</strong></p>
<ul>
<li><p>获取 通过<code>hexo generate</code>命令生成后的文件夹（生成之后文件夹为/public文件夹）的所在路径。</p>
<pre><code>{% asset_path google.png %}
</code></pre>  /2016/12/15/写作相关(1)-Hexo标签插件的使用/google.png
</li>
</ul>
<ul>
<li><p>读取资源文件夹内的资源显示在文章中。</p>
<pre><code>{% asset_img google.png googlImage %}
</code></pre>  <img src="/2016/12/15/写作相关(1)-Hexo标签插件的使用/google.png" alt="googleImage" title="googleImage">
</li>
</ul>
<ul>
<li><p>通过点击title获取tag.png资源。   </p>
<pre><code>{% asset_link google.png googlImage %}
</code></pre>  <a href="/2016/12/15/写作相关(1)-Hexo标签插件的使用/google.png" title="googleImage">googleImage</a>
</li>
</ul>
<p><strong>获取pdf资源(获取code资源也是如此，与此类推，无法显示的文件，只能通过点击link来获取)</strong></p>
<ul>
<li><p>获取 通过<code>hexo generate</code>命令生成后的文件夹的所在路径。</p>
<pre><code>{% asset_path functional-swift-cn-2016-06-07.pdf %}
</code></pre>  /2016/12/15/写作相关(1)-Hexo标签插件的使用/functional-swift-cn-2016-06-07.pdf
</li>
</ul>
<ul>
<li><p>读取资源文件夹内的资源显示在文章中。(因为pdf文件太大，所以无法显示，通过点击显示区域，即可读取此pdf文件)</p>
<pre><code>{% asset_img functional-swift-cn-2016-06-07.pdf functional-swift %}
</code></pre>  <img src="/2016/12/15/写作相关(1)-Hexo标签插件的使用/functional-swift-cn-2016-06-07.pdf" alt="functional-swift" title="functional-swift">
</li>
</ul>
<ul>
<li><p>通过点击title获取tag.png资源。   </p>
<pre><code>{% asset_link functional-swift-cn-2016-06-07.pdf functional-swift %}
</code></pre>  <a href="/2016/12/15/写作相关(1)-Hexo标签插件的使用/functional-swift-cn-2016-06-07.pdf" title="functional-swift">functional-swift</a>    
</li>
</ul>
<h1 id="Gist"><a href="#Gist" class="headerlink" title="Gist"></a>Gist</h1><script src="//gist.github.com/gist_id.js?file=[filename]"></script>
<h1 id="jsFiddle"><a href="#jsFiddle" class="headerlink" title="jsFiddle"></a>jsFiddle</h1><iframe scrolling="no" width="50" height="50" src="http://jsfiddle.net/shorttag/embedded/[tabs]/[skin]" frameborder="0" allowfullscreen></iframe>
<h1 id="引用文章"><a href="#引用文章" class="headerlink" title="引用文章"></a>引用文章</h1><h1 id="Raw"><a href="#Raw" class="headerlink" title="Raw"></a>Raw</h1><p>如果您想在文章中插入 Swig 标签，可以尝试使用 Raw 标签，以免发生解析异常。</p>
<p>格式：</p>
<pre><code>{% raw %}
    content
{% endraw %}
</code></pre><p>显示效果：</p>
<pre><code>{% raw %}
    {% asset_link functional-swift-cn-2016-06-07.pdf title %}
    {% asset_path google.png %}
{% endraw %}  
</code></pre>

{% asset_link functional-swift-cn-2016-06-07.pdf title %}

{% asset_path google.png %}

  
<h1 id="可以插入音乐"><a href="#可以插入音乐" class="headerlink" title="可以插入音乐"></a>可以插入音乐</h1><p><a href="https://www.zhihu.com/question/50741481" target="_blank" rel="external">https://www.zhihu.com/question/50741481</a></p>
<h1 id="Pull-Quote"><a href="#Pull-Quote" class="headerlink" title="Pull Quote"></a>Pull Quote</h1><pre><code>{% pullquote  %}
    content
    {% endpullquote %}
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/12/怎么建立自己的技术博客/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="超CniceToUpp">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpeg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="歇斯底里 摧枯拉朽">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="歇斯底里 摧枯拉朽" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/12/怎么建立自己的技术博客/" itemprop="url">
                  怎么建立自己的技术博客
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-12T22:01:27+08:00">
                2016-12-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/博客/" itemprop="url" rel="index">
                    <span itemprop="name">博客</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/12/12/怎么建立自己的技术博客/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/12/12/怎么建立自己的技术博客/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="安装HEXO"><a href="#安装HEXO" class="headerlink" title="安装HEXO"></a>安装HEXO</h1><p>在安装HEXO之前，需要先安装</p>
<ul>
<li>Git</li>
<li>Node</li>
</ul>
<p>如果是window或者Linux用户，可以参考<a href="https://hexo.io/zh-cn/docs/index.html" target="_blank" rel="external">这里</a></p>
<p>如果是macOX用户，可以直接通过<a href="http://brew.sh/" target="_blank" rel="external">Homebrew</a>安装，安装过程超级简单</p>
<p><code>$ brew install git</code></p>
<p><code>$ brew install node</code></p>
<p><code>$ npm install -g hexo-cli</code></p>
<p>如果是和下面图片所示一样，则操作成功.</p>
<img src="/resources/images/checkIfsuccessToinstlalHexo.png" width="200" height="200" title="核查hexo是否安装成功">
<h1 id="建立站点"><a href="#建立站点" class="headerlink" title="建立站点"></a>建立站点</h1><p>安装Hexo完成之后，接着就要在指定文件夹中通过命令新建所需要的站点文件夹<br>我要把站点文件夹创建在/Users/hechao/Documents/TechBlog目录下，所以我通过如下命令创建站点文件夹<br><code>$ cd /Users/hechao/Documents/TechBlog</code><br><code>$ hexo init CniceToUpp</code><br><code>$ cd CniceToUpp</code><br><code>$ npm install</code><br>站点列表如下：<br><img src="/resources/images/siteDirList.png" width="200" height="200" title="站点文件夹目录树"></p>
<h2 id="themes"><a href="#themes" class="headerlink" title="themes"></a>themes</h2><p>主题文件夹。Hexo会根据主题来生成静态页面，这里面默认用的是landscape主题，可以自行选择<a href="https://hexo.io/themes/" target="_blank" rel="external">Hexo主题</a>，本人选择的是Nextz主题。</p>
<h2 id="source"><a href="#source" class="headerlink" title="source"></a>source</h2><p>资源文件夹。存放用户资源的地方，例如文章，草稿，page，图片等等资源。除了<code>_posts</code>文件夹之外，开头命令为_(下划线)的文件/文件夹和隐藏文件将会忽略。Markdown和HTML文件会被解析并放到public文件夹，而其他文件会被拷贝过去  </p>
<h2 id="scaffolds"><a href="#scaffolds" class="headerlink" title="scaffolds"></a>scaffolds</h2><p>模板文件夹。当我们新建文章时，Hexo会根据scaffold来建立文件</p>
<h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><p>应用程序的信息。EJS, Stylus 和 Markdown renderer 已默认安装，您可以自由移除</p>
<h2 id="config-yml"><a href="#config-yml" class="headerlink" title="_config.yml"></a>_config.yml</h2><p>网站的配置信息，我们可以在此配置大部分的参数。</p>
<h2 id="public"><a href="#public" class="headerlink" title="public"></a>public</h2><p>此外public目录是一开始没有的，只有在根目录下执行<a href="#user-content-generate">hexo generate</a>命令，才会生产public目录，此目录下存放着生成站点所需要的静态网页，渲染文件等文件。</p>
<p>最原始的技术博客界面如下：</p>
<img src="/resources/images/originalblog.png" width="400" height="400" title="最初的技术博客界面">
<h1 id="在-config-yml配置站点信息"><a href="#在-config-yml配置站点信息" class="headerlink" title="在_config.yml配置站点信息"></a>在_config.yml配置站点信息</h1><p>如果想要更好的装饰我们的技术博客，那应该要怎么办，那么首先得学会在<code>/_config.yml</code>文件中配置一些基本信息</p>
<h2 id="基本配置信息"><a href="#基本配置信息" class="headerlink" title="基本配置信息"></a>基本配置信息</h2><table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:center">描述</th>
<th>扩展</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">title</td>
<td style="text-align:center">网站标题  </td>
</tr>
<tr>
<td style="text-align:center">subtitle</td>
<td style="text-align:center">网站副标题  </td>
</tr>
<tr>
<td style="text-align:center">description</td>
<td style="text-align:center">网站描述  </td>
</tr>
<tr>
<td style="text-align:center">author</td>
<td style="text-align:center">网站作者  </td>
</tr>
<tr>
<td style="text-align:center">language</td>
<td style="text-align:center">网站使用的语言</td>
<td>简体中文就是zh-Hans 具体看<a href="http://www.ruanyifeng.com/blog/2008/02/codes_for_language_names.html" target="_blank" rel="external">这里</a> </td>
</tr>
<tr>
<td style="text-align:center">timezone</td>
<td style="text-align:center">网站时区</td>
<td>Hexo 默认使用您电脑的时区。<a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" target="_blank" rel="external">时区列表</a>。比如说：America/New_York, Japan, 和 UTC 。</td>
</tr>
</tbody>
</table>
<h2 id="网址配置信息-暂时不写"><a href="#网址配置信息-暂时不写" class="headerlink" title="网址配置信息(暂时不写)"></a>网址配置信息(暂时不写)</h2><table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:center">描述</th>
<th>扩展</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">url</td>
<td style="text-align:center">网站标题  </td>
</tr>
<tr>
<td style="text-align:center">subtitle</td>
<td style="text-align:center">网站副标题  </td>
</tr>
<tr>
<td style="text-align:center">description</td>
<td style="text-align:center">网站描述  </td>
</tr>
<tr>
<td style="text-align:center">author</td>
<td style="text-align:center">网站作者  </td>
</tr>
</tbody>
</table>
<h2 id="目录配置信息-暂时不写"><a href="#目录配置信息-暂时不写" class="headerlink" title="目录配置信息(暂时不写)"></a>目录配置信息(暂时不写)</h2><table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:center">描述</th>
<th>扩展</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">source_dir</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">public_dir</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">tag_dir</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">archive_dir</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">category_dir</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">code_dir</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">i18n_dir</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">skip_render</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h2 id="写作相关配置信息-暂时不写"><a href="#写作相关配置信息-暂时不写" class="headerlink" title="写作相关配置信息(暂时不写)"></a>写作相关配置信息(暂时不写)</h2><table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:center">描述</th>
<th>扩展</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">new_post_name</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">default_layout</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">titlecase</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">external_link</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">filename_case</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">render_drafts</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">post_asset_folder</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">relative_link</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">future</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h2 id="高亮相关配置信息-暂时不写"><a href="#高亮相关配置信息-暂时不写" class="headerlink" title="高亮相关配置信息(暂时不写)"></a>高亮相关配置信息(暂时不写)</h2><table>
<thead>
<tr>
<th style="text-align:center">highlight</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">enable</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">line_number</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">auto_detect</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">tab_replace</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h1 id="hexo常用命令"><a href="#hexo常用命令" class="headerlink" title="hexo常用命令"></a>hexo常用命令</h1><h2 id="init"><a href="#init" class="headerlink" title="init"></a>init</h2><p><code>$ Hexo init [foldername]</code></p>
<p>新建一个网站文件夹。如果没有设置folder，Hexo默认在目前的文件夹建立网站文件夹<br>例如：</p>
<p><code>$ cd /Users/hechao/Documents/TechBlog</code></p>
<p><code>$ hexo init CniceToUpp</code></p>
<p>执行上面的shell命令，网站文件夹就会在CniceToUpp目录下。</p>
<h2 id="new"><a href="#new" class="headerlink" title="new"></a>new</h2><p><code>$ hexo new [layout] &lt;title&gt;</code></p>
<p>新建一篇文章。如果没有设置 layout 的话，默认使用 _config.yml 中的 default_layout 参数代替。如果标题包含空格的话，请使用引号括起来。<br>例如：<br><code>hero new post testpost</code></p>
<blockquote>
<p> <strong>文章布局</strong><br>Hexo 有三种默认布局：post、page 和 draft，使用不同的layout，文件会被创建到不同的路径，而默认的布局和 post 相同，都将储存到 source/_posts 文件夹。</p>
<table>
<thead>
<tr>
<th>布局</th>
<th>路径</th>
</tr>
</thead>
<tbody>
<tr>
<td>post</td>
<td>/source/_posts</td>
</tr>
<tr>
<td>page</td>
<td>/source</td>
</tr>
<tr>
<td>draft</td>
<td>/source/_drafts</td>
</tr>
</tbody>
</table>
<ul>
<li>如果布局为<code>post</code>的话，生成的文件就会被创建到<br>/Users/hechao/Documents/TechBlog/CniceToUpp/source/_posts下去，此文件夹下面会创建一个与title同名的.md文件。</li>
<li>如果布局为<code>page</code>，这会在source目录下自动创建与title同名的文件夹，而在此文件夹下面，会创建一个index.md文件。</li>
<li>如果布局为<code>draft</code>，这会在source目录下自动创建_draft文件夹，此文件夹下面会创建一个与title同名的.md文件</li>
</ul>
<p><strong>文章对应的文件名称</strong><br>文章对应的文件名称默认以title作为文件名称，但我们可以通过设置/_config.yml文件里的new_post_name参数来改变默认的此名称，举例来说，设为 :year-:month-:day-:title.md 可让您更方便的通过日期来管理文章。</p>
<table>
<thead>
<tr>
<th>变量</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>:title</td>
<td>标题(小写，空格将会被替换为短杠)</td>
</tr>
<tr>
<td>:year</td>
<td>建立的年份，比如， 2015</td>
</tr>
<tr>
<td>:month</td>
<td>建立的月份（有前导零），比如， 04</td>
</tr>
<tr>
<td>:i_month</td>
<td>建立的月份（无前导零），比如， 4</td>
</tr>
<tr>
<td>:day</td>
<td>建立的日期（有前导零），比如， 07</td>
</tr>
<tr>
<td>:i_day</td>
<td>建立的日期（无前导零），比如， 7</td>
</tr>
</tbody>
</table>
<p><strong>文章草稿</strong><br>刚刚提到了一种特殊文章布局:draft,这种布局在建立时会被保存到/source/_drafts 文件夹，您可通过 publish 命令将草稿移动到 source/_posts 文件夹，该命令的使用方式与 new 十分类似，您也可在命令中指定 layout 来指定布局。</p>
<p><code>$ hexo publish [layout] &lt;title&gt;</code></p>
<p>这句话待解释&lt;草稿默认不会显示在页面中，您可在执行时加上 –draft 参数，或是把 render_drafts 参数设为 true 来预览草稿。&gt;</p>
<p><strong>模版（Scaffold）</strong><br>在新建文章时，Hexo 可以根据 scaffolds 文件夹内相对应的文件来建立文件，例如：</p>
<p><code>$ hexo new photo &quot;title&quot;</code></p>
<p>在执行这行指令时,Hexo会尝试在scaffolds文件夹中寻找photo.md,并根据其内容建立文章,以下是您可以在模版中使用的<a href="#1">Front-matter</a>变量：</p>
<table>
<thead>
<tr>
<th>变量</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>layout</td>
<td>布局</td>
</tr>
<tr>
<td>title</td>
<td>标题</td>
</tr>
<tr>
<td>date</td>
<td>文件建立日期</td>
</tr>
</tbody>
</table>
<p>模板里面的内容可以自行定义</p>
</blockquote>
<h2 id="generate"><a href="#generate" class="headerlink" title="generate"></a>generate</h2><p><code>$ hexo generate</code></p>
<p>生成静态文件<br>| 选项 | 描述 |<br>| —–| ————- |<br>| -d,–deploy | 文件生成之后立即部署网站|<br>| -w,–watch | 监视文件变动      |<br>| -f,–force | 强制重新生成静态文件      | </p>
<h2 id="publish"><a href="#publish" class="headerlink" title="publish"></a>publish</h2><p><code>$ hexo publish [layout] &lt;filename&gt;</code></p>
<p>发表草稿</p>
<h2 id="server"><a href="#server" class="headerlink" title="server"></a>server</h2><p><code>$ hexo server</code>   </p>
<p>启动本地hero服务器。默认情况下，访问网址为：<a href="http://localhost:4000/,但是我们执行这个命令之后，有可能提示hero是在http://0.0.0.0:4000/上运行的，localhost是一个域名，用于指代this" target="_blank" rel="external">http://localhost:4000/,但是我们执行这个命令之后，有可能提示hero是在http://0.0.0.0:4000/上运行的，localhost是一个域名，用于指代this</a> computer或者this host，127.0.0.1 是一个环回地址。并不表示“本机”。0.0.0.0才是真正表示“本网络中的本机.关于ip的知识可以参考<a href="http://blog.onlycatch.com/post/7e371ca28621" target="_blank" rel="external">这里</a></p>
<table>
<thead>
<tr>
<th>选项</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>-i, –ip</td>
<td>重设默认的hexo服务器IP地址，hexo会通过默认的ip地址绑定所有的本机IP地址，一个主机机可能会有多个IP地址</td>
</tr>
<tr>
<td>-s, –static</td>
<td>只使用静态文件</td>
</tr>
<tr>
<td>-o,–open</td>
<td>hero服务器一旦启动，就会立马在默认的浏览器打开服务器url</td>
</tr>
<tr>
<td>-l,–log [format]</td>
<td>开启日志记录，并可以重写log格式</td>
</tr>
<tr>
<td>-p,–port</td>
<td>重设默认端口</td>
</tr>
</tbody>
</table>
<h2 id="deploy"><a href="#deploy" class="headerlink" title="deploy"></a>deploy</h2><p><code>$ hexo deploy</code></p>
<p>部署网站。如果使用的是github作为网站服务器，则使用此命令将生产的静态网页发布(上传)到giuhub服务器中去。</p>
<h2 id="render"><a href="#render" class="headerlink" title="render"></a>render</h2><p><code>$ hexo render &lt;file1&gt; [file2] ...</code></p>
<table>
<thead>
<tr>
<th>选项</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>-o, –output</td>
<td>设置输出路径</td>
</tr>
</tbody>
</table>
<h2 id="clean"><a href="#clean" class="headerlink" title="clean"></a>clean</h2><p><code>$ hexo clean</code></p>
<p>清除缓存文件 (\db.json) 和已生成的静态文件 (\public)。</p>
<h2 id="version"><a href="#version" class="headerlink" title="version"></a>version</h2><p><code>$ hexo version</code></p>
<p>显示 Hexo 版本。</p>
<h1 id="Front-matter"><a href="#Front-matter" class="headerlink" title="Front-matter"></a>Front-matter</h1><p>Front-matter 是文件最上方以 — 分隔的区域，用于指定个别文件的变量，举例来说：</p>
<img src="/resources/images/Front-matter.png" width="200" height="200" title="Front-matter">
<p>以下是预先定义的参数，您可在模板中使用这些参数值并加以利用。</p>
<table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:center">描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">layout</td>
<td style="text-align:center">布局</td>
<td>根据文章生成命令用的参数 </td>
</tr>
<tr>
<td style="text-align:center">title</td>
<td style="text-align:center">标题</td>
<td>根据文章生成命令用的参数 </td>
</tr>
<tr>
<td style="text-align:center">date</td>
<td style="text-align:center">建立日期</td>
<td>文件建立日期</td>
</tr>
<tr>
<td style="text-align:center">updated</td>
<td style="text-align:center">更新日期</td>
<td>文件更新日期 </td>
</tr>
<tr>
<td style="text-align:center">comments</td>
<td style="text-align:center">开启文章的评论功能</td>
<td>true </td>
</tr>
<tr>
<td style="text-align:center">tags</td>
<td style="text-align:center">标签（不适用于分页）</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">categories</td>
<td style="text-align:center">分类（不适用于分页）</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">permalink</td>
<td style="text-align:center">覆盖文章网址</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="分类与标签"><a href="#分类与标签" class="headerlink" title="分类与标签"></a>分类与标签</h2><p>只有文章支持分类和标签，您可以在 Front-matter 中设置，在站点生成目录/public中会生产tags目录和categories目录。在其他系统中，分类和标签听起来很接近，但是在 Hexo 中两者有着明显的差别：</p>
<img src="/resources/images/category.png" width="200" height="200" title="categories目录树">
<img src="/resources/images/tag.png" width="200" height="200" title="tag目录树">
<p>上面两张图的上层目录是public目录。</p>
<p>从上面两图中可以看出，分类具有顺序性和层次性，也就是说 category1, category2 不等于 category2, category1；而标签没有顺序和层次。</p>
<h3 id="JSON-Front-matter"><a href="#JSON-Front-matter" class="headerlink" title="JSON Front-matter"></a>JSON Front-matter</h3><p>除了 YAML 外，你也可以使用 JSON 来编写 Front-matter，只要将 — 代换成 ;;; 即可。</p>
<blockquote>
<p>“title”: “Hello World”,</p>
<p>“date”: “2013/7/13 20:46:25</p>
<p>;;;</p>
</blockquote>
<h1 id="设置博客主题"><a href="#设置博客主题" class="headerlink" title="设置博客主题"></a>设置博客主题</h1><p>如果想要切换其他Hexo主题，我们首先在<code>/themes</code>文件夹之内添加一个主题文件夹，并修改<code>/_config.yml</code>内的<code>theme</code>参数，这样子就可以切换主题了，是不是很简单。主题可以在这里选择<a href="https://hexo.io/themes/" target="_blank" rel="external">这里</a>下载,我使用的是<a href="http://theme-next.iissnan.com/" target="_blank" rel="external">Next主题</a>.</p>
<ul>
<li><p>克隆最新版本的Next主题文件(除了克隆还可以下载<a href="https://github.com/iissnan/hexo-theme-next/releases" target="_blank" rel="external">稳定版本</a>)</p>
<p>  <code>$ cd your-hexo-site</code></p>
<p>  <code>$ git clone http://github.com/iissnan/hexo-theme-next themes/next</code></p>
</li>
<li><p>修改站点配置文件<code>/_config.yml</code></p>
  <img src="/resources/images/theme.png" width="200" height="200" title="修改前的主题配置">
  <img src="/resources/images/toTheme.png" width="200" height="200" title="修改后的主题配置">
</li>
</ul>
<p>完成上述两部操作之后，先清理缓存，然后生成public静态文件夹，接着重启服务器，生成的新的博客主题界面如下：</p>
<img src="/resources/images/NextTheme.png" width="400" height="400" title="Next主题界面">
<h1 id="部署博客"><a href="#部署博客" class="headerlink" title="部署博客"></a>部署博客</h1><p>想要部署博客到服务器上，首先必须要在/_config.yml中修改参数，</p>
<h2 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a>第一步</h2><ul>
<li><p>git 作为版本控制工具的话</p>
<p>  安装<code>hexo-deploy-git</code>插件，在/node_modules中查看是否安装了hexo-deploy-git插件，如果没有安装的话，在根目录<code>/</code>下执行如下命令安装插件</p>
<pre><code>$ npm install hexo-deployer-git --save
</code></pre></li>
<li><p>Heroku 作为版本控制工具的话</p>
<p>  安装<code>hexo-deployer-heroku</code>插件，在/node_modules中查看是否安装了hexo-deployer-heroku插件，如果没有安装的话，在根目录<code>/</code>下执行如下命令安装插件</p>
<pre><code>$ npm install hexo-deployer-heroku --save
</code></pre></li>
</ul>
<h2 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a>第二步</h2><p>在<code>站点配置文件</code>下修改配置</p>
<img src="/resources/images/deployConfig.png" width="400" height="400" title="部署配置">
<table>
<thead>
<tr>
<th>选项</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>版本控制工具(git,heroku)</td>
</tr>
<tr>
<td>repo</td>
<td>库（Repository）地址</td>
</tr>
<tr>
<td>branch</td>
<td>分支名称。如果您使用的是 GitHub 或 GitCafe 的话，程序会尝试自动检测。（Heroku 没有此选项）</td>
</tr>
<tr>
<td>message</td>
<td>自定义提交信息</td>
</tr>
</tbody>
</table>
<p>上述选项至少要配置type参数, 版本控制工具可以选择多个，Hexo会依照顺序执行每个deployer。</p>
<pre><code>deploy:
- type: git
  repo:
- type: heroku
  repo:
</code></pre><h2 id="第三步"><a href="#第三步" class="headerlink" title="第三步"></a>第三步</h2><p>在根目录<code>/</code>下执行 <code>$ hexo deploy</code> 命令，在执行命令之前，需先<code>hexo clean</code>和<code>hexo generate</code></p>
<h1 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h1><p><strong>Tip1：静态模式指的是服务器只处理public文件夹内的文件，而不会处理文件变动，在执行时，我们应该先自行执行如下命令：</strong></p>
<ul>
<li><code>hexo clean</code> : 清除缓存文件 <code>(\db.json)</code> 和已生成的静态文件 <code>(\public)</code></li>
<li><code>hexo generate</code> : 生成最新的静态文件</li>
<li><code>hexo server -so</code> : 服务器只处理public文件夹内的文件，并打开博客网页</li>
</ul>
<p><strong>Tip2: hexo命令都是在站点文件夹执行命令的</strong></p>
<p><strong>Tip3: 根目录就是站点文件夹路径，如：/Users/hechao/Documents/TechBlog/CniceToUpp,如果在看到<code>/</code>，则代表hero站点根目录</strong></p>
<p><strong>Tip4: 因为_config.yml是yml文件，所以在设置参数时一定要在冒号右边留一个空格。例如：author: hechao</strong></p>
<p><strong>Tip5:<br><code>hexo generate</code> 简写形式为 <code>hexo g</code><br><code>hexo deploy</code> 简写形式为 <code>hexo d</code><br><code>hexo server</code> 简写形式为 <code>hexo s</code></strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/26/CocoaPods的使用/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="超CniceToUpp">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpeg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="歇斯底里 摧枯拉朽">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="歇斯底里 摧枯拉朽" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/26/CocoaPods的使用/" itemprop="url">
                  CocoaPods的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-03-26T13:17:31+08:00">
                2016-03-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/03/26/CocoaPods的使用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/03/26/CocoaPods的使用/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一-什么是CocoaPods"><a href="#一-什么是CocoaPods" class="headerlink" title="一.什么是CocoaPods"></a>一.什么是CocoaPods</h1><h2 id="1、为什么需要CocoaPods"><a href="#1、为什么需要CocoaPods" class="headerlink" title="1、为什么需要CocoaPods"></a>1、为什么需要CocoaPods</h2><p>在进行iOS开发的时候，总免不了使用第三方的开源库，比如SBJson、AFNetworking、Reachability等等。使用这些库的时候通常需要：</p>
<ul>
<li>下载开源库的源代码并引入工程</li>
<li>向工程中添加开源库使用到的framework</li>
<li>解决开源库和开源库以及开源库和工程之间的依赖关系、检查重复添加的framework等问题</li>
<li>如果开源库有更新的时候，还需要将工程中使用的开源库删除，重新执行前面的三个步骤，顿时头都大了。。。</li>
</ul>
<p>自从有了CocoaPods以后，这些繁杂的工作就不再需要我们亲力亲为了，只需要我们做好少量的配置工作，CocoaPods会为我们做好一切！</p>
<h2 id="2、什么是CocoaPods"><a href="#2、什么是CocoaPods" class="headerlink" title="2、什么是CocoaPods"></a>2、什么是CocoaPods</h2><p><code>CocoaPods是一个用来帮助我们管理第三方依赖库的工具。</code>它可以解决库与库之间的依赖关系，下载库的源代码，同时通过创建一个Xcode的workspace来将这些第三方库和我们的工程连接起来，供我们开发使用。</p>
<p>使用CocoaPods的目的是让我们能自动化的、集中的、直观的管理第三方开源库。</p>
<h1 id="二-安装CocoaPods"><a href="#二-安装CocoaPods" class="headerlink" title="二.安装CocoaPods"></a>二.安装CocoaPods</h1><h2 id="安装CocoaPods"><a href="#安装CocoaPods" class="headerlink" title="安装CocoaPods"></a>安装CocoaPods</h2><p>CocoaPods是由Ruby实现的，所以它要保证在OSX系统中Ruby可用的情况下安装。注意:在安装CocoaPods时需要使用<code>sudo</code>(超级用户权限)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo gem install cocoapods</div></pre></td></tr></table></figure>
<h2 id="升级CocoaPods"><a href="#升级CocoaPods" class="headerlink" title="升级CocoaPods"></a>升级CocoaPods</h2><p>升级CocoaPods很简单，就是再一次执行安装命令即可:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo gem install cocoapods</div></pre></td></tr></table></figure>
<p>或者预发布版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo gem install cocoapods --pre</div></pre></td></tr></table></figure>
<h1 id="三-使用CocoaPods"><a href="#三-使用CocoaPods" class="headerlink" title="三.使用CocoaPods"></a>三.使用CocoaPods</h1><h2 id="安装Pod到Xcode工程中"><a href="#安装Pod到Xcode工程中" class="headerlink" title="安装Pod到Xcode工程中"></a>安装Pod到Xcode工程中</h2><ul>
<li><p>创建一个Profile文件</p>
</li>
<li><p>添加自己所需要的第三方依赖</p>
</li>
<li><p>在工程目录中运行<code>$ pod install</code></p>
</li>
<li><p>打开<code>App.xcworkspace</code>,开始工作</p>
</li>
</ul>
<h3 id="1-创建Profile文件"><a href="#1-创建Profile文件" class="headerlink" title="1.创建Profile文件"></a>1.创建Profile文件</h3><p>可以<code>手动创建</code>Profile文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cd /Users/hechao/Desktop/练习/NetEaseHome</div><div class="line">$ touch Profile</div></pre></td></tr></table></figure>
<p>也可以使用<code>$ pod init</code>命令创建Profile文件</p>
<p><img src="/resources/images/profile_create.png" alt="image"></p>
<h3 id="编辑Profile-添加自己所需要的第三方依赖"><a href="#编辑Profile-添加自己所需要的第三方依赖" class="headerlink" title="编辑Profile(添加自己所需要的第三方依赖)"></a>编辑Profile(添加自己所需要的第三方依赖)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># Uncomment this line to define a global platform for your project</div><div class="line">platform :ios, &apos;8.0&apos;</div><div class="line"># Uncomment this line if you&apos;re using Swift</div><div class="line"># use_frameworks!</div><div class="line"></div><div class="line">target &apos;NetEaseHome&apos; do</div><div class="line">  pod &apos;AFNetworking&apos;, &apos;~&gt; 3.0.0-beta.3&apos;</div><div class="line">  pod &apos;FBSDKCoreKit&apos;, &apos;~&gt; 4.9&apos;</div><div class="line">end</div></pre></td></tr></table></figure>
<h3 id="在工程目录中运行-pod-install"><a href="#在工程目录中运行-pod-install" class="headerlink" title="在工程目录中运行$ pod install"></a>在工程目录中运行<code>$ pod install</code></h3><p>pod install的时候可能会出现如下错误</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">HCdeMacBook-hechao:NetEaseHome hechao$ pod install</div><div class="line">Updating local specs repositories</div><div class="line">Analyzing dependencies</div><div class="line">[!] Unable to satisfy the following requirements:</div><div class="line"></div><div class="line">- `FBSDKCoreKit (~&gt; 4.9)` required by `Podfile`</div><div class="line"></div><div class="line">[!] CocoaPods was not able to update the `master` repo. If this is an unexpected issue and persists you can inspect it running `pod repo update --verbose`</div></pre></td></tr></table></figure>
<p>解决办法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ pod repo remove master</div><div class="line">$ pod setup</div></pre></td></tr></table></figure>
<h3 id="打开App-xcworkspace-开始工作"><a href="#打开App-xcworkspace-开始工作" class="headerlink" title="打开App.xcworkspace,开始工作"></a>打开<code>App.xcworkspace</code>,开始工作</h3><p><img src="/resources/images/pod_install.png" alt="image"></p>
<p>到这里基本pod的使用已经说明完成，接下来我们来讨论下pod的其他问题</p>
<h1 id="cocoapods的一些命令的使用及其注意点"><a href="#cocoapods的一些命令的使用及其注意点" class="headerlink" title="cocoapods的一些命令的使用及其注意点"></a>cocoapods的一些命令的使用及其注意点</h1><h2 id="pod-install-vs-pod-update"><a href="#pod-install-vs-pod-update" class="headerlink" title="pod install vs. pod update"></a>pod install vs. pod update</h2><h3 id="pod-install"><a href="#pod-install" class="headerlink" title="pod install"></a>pod install</h3><ul>
<li>当我们运行<code>$ pod install</code>的时候(Profile.lock文件是跟踪每个pod的安装版本并且锁住它们）<ul>
<li>对于在Podfile.lock文件列表中pods，就下载Podfile.lock文件中列好的版本pod，而不会去检查这个pod是否有更新可用的</li>
<li>对于不在Podfile.lock文件列表中pods，就会去下载Profile文件中的对应的版本pod，并把安装好的pod版本写进Profile.lock文件中</li>
</ul>
</li>
</ul>
<h3 id="pod-update"><a href="#pod-update" class="headerlink" title="pod update"></a>pod update</h3><p>当我们运行<code>pod update PODNAME</code>，cocoapods不会去考虑Podfile.lock文件中的名为PODNAME的pod版本，而是会去cocoapods中寻找并下载名为PODNAME的最新的pod（Profile文件中的描述的版本），如果<code>pod update</code>没有带名字，那么CocoaPods会更新Podfile列出来的每一个pod，并更新版本到Profile中描述的版本</p>
<h3 id="如何使用pod-install-和-pod-update"><a href="#如何使用pod-install-和-pod-update" class="headerlink" title="如何使用pod install 和 pod update"></a>如何使用pod install 和 pod update</h3><ul>
<li>仅仅当我们需要更新某个pod，或者更新每一个pod的时候，我们才用pod update</li>
<li>当我们向Profile中添加一个pod的时候，我们应该使用pod install，而不是pod update</li>
</ul>
<h3 id="提醒要提交Podfile-lock"><a href="#提醒要提交Podfile-lock" class="headerlink" title="提醒要提交Podfile.lock"></a>提醒要提交Podfile.lock</h3><p>提醒：我们应该总是commit和push我们的Podfile.lock文件，而不用提交Pods文件夹</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/25/iOS远程推送实现原理/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="超CniceToUpp">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpeg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="歇斯底里 摧枯拉朽">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="歇斯底里 摧枯拉朽" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/25/iOS远程推送实现原理/" itemprop="url">
                  iOS远程推送实现原理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-03-25T16:00:32+08:00">
                2016-03-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/03/25/iOS远程推送实现原理/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/03/25/iOS远程推送实现原理/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="什么是远程通知？"><a href="#什么是远程通知？" class="headerlink" title="什么是远程通知？"></a>什么是远程通知？</h1><ul>
<li>顾名思义，就是从远程服务器推送给客户端的通知（需要联网），远程推送服务，又称为APNs(Apple Push Notification Services)</li>
</ul>
<h1 id="远程通知原理"><a href="#远程通知原理" class="headerlink" title="远程通知原理"></a>远程通知原理</h1><p>通过图来解释整个远程通知的过程</p>
<p><img src="/resources/images/remoteNotification.png" alt="image"></p>
<h1 id="远程通知怎么用？"><a href="#远程通知怎么用？" class="headerlink" title="远程通知怎么用？"></a>远程通知怎么用？</h1><h2 id="第一步-安装证书"><a href="#第一步-安装证书" class="headerlink" title="第一步.安装证书"></a>第一步.安装证书</h2><ul>
<li>aps_production.cer:如果发布的程序包含了推送服务，就必须要安装这个证书</li>
<li>ios_distribution:让电脑具备发布程序的能力</li>
<li>APP_NAME.mobileprovision：某台电脑就能发布某个程序</li>
</ul>
<h2 id="第二步-注册通知"><a href="#第二步-注册通知" class="headerlink" title="第二步.注册通知"></a>第二步.注册通知</h2><p>注册通知的代码是在<em>didFinishlaunchingWithOption</em>方法中，在iOS8之前和之后注册的形式稍许不同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</div><div class="line">&#123;</div><div class="line">   </div><div class="line">    if ([UIDevice currentDevice].systemVersion.doubleValue &lt;= 8.0) &#123;</div><div class="line">        // 不是iOS8</div><div class="line">        UIRemoteNotificationType type = UIRemoteNotificationTypeBadge | UIRemoteNotificationTypeSound | UIRemoteNotificationTypeAlert;</div><div class="line">        // 当用户第一次启动程序时就获取deviceToke</div><div class="line">        // 该方法在iOS8以及过期了</div><div class="line">        // 只要调用该方法, 系统就会自动发送UDID和当前程序的Bunle ID到苹果的APNs服务器</div><div class="line">        [application registerForRemoteNotificationTypes:type];</div><div class="line">    &#125;</div><div class="line">    else &#123;</div><div class="line">        // iOS8</div><div class="line">        UIUserNotificationType type = UIUserNotificationTypeBadge | UIUserNotificationTypeAlert | UIUserNotificationTypeSound;</div><div class="line"></div><div class="line">        UIUserNotificationSettings* settings = [UIUserNotificationSettings settingsForTypes:type categories:nil];</div><div class="line">        // 注册通知类型</div><div class="line">        [application registerUserNotificationSettings:settings];</div><div class="line"></div><div class="line">        // 申请试用通知</div><div class="line">        [application registerForRemoteNotifications];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //注意:当我们调用_application_中_registerForRemoteNotificatioinTypes_(IOS8之前)或者    </div><div class="line">    //_registerForRemoteNotifications_(IOS8之后)这两个函数的时候，系统就会把`手机设备的UDID`和`当前程序</div><div class="line">    //的Bundle ID`发送到苹果的APNs服务器。</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="第三步-获取deviceToken"><a href="#第三步-获取deviceToken" class="headerlink" title="第三步.获取deviceToken"></a>第三步.获取deviceToken</h2><p>注册成功之后会调用APPdelegate的didRegisterForRemoteNotificationsWithDeviceTiken方法获得苹果服务器返回的deviceToken</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> *  获取到用户对应当前应用程序的deviceToken时就会调用</div><div class="line"> */</div><div class="line">- (void)application:(UIApplication *)application 9didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken</div><div class="line">&#123;</div><div class="line">    NSLog(@&quot;%@&quot;, deviceToken);</div><div class="line">    // &lt;47e58207 31340f18 ed83ba54 f999641a 3d68bc7b f3e2db29 953188ec 7d0cecfb&gt;</div><div class="line">    // &lt;286c3bde 0bd3b122 68be655f 25ed2702 38e31cec 9d54da9f 1c62325a 93be801e&gt;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>获取到deviceToken之后，就需要把deviceToken和用户的标志发送到自己的客户端服务器，存进数据库中</p>
<h2 id="第四步-通知发送"><a href="#第四步-通知发送" class="headerlink" title="第四步.通知发送"></a>第四步.通知发送</h2><p>如果李四给张三发消息的话,首先发送到自己的服务中,然后去数据库中查询张三的deviceToken,如果找到的话,服务器取回deviceToken，自己的服务器把deviceToken和信息通知苹果服务器，苹果服务器通过deviceToken找到张三的设备，哪个程序，推送过去。</p>
<h2 id="第五步-苹果服务器推送过来之后"><a href="#第五步-苹果服务器推送过来之后" class="headerlink" title="第五步.苹果服务器推送过来之后"></a>第五步.苹果服务器推送过来之后</h2><ul>
<li><p>在应用程序是打开状态(前台或者是后台)</p>
<p>(1)    在iOS7以前</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">	/*</div><div class="line"> ios7以前苹果支持多任务, iOS7以前的多任务是假的多任务</div><div class="line"> 而iOS7开始苹果才真正的推出了多任务</div><div class="line"> */</div><div class="line">// 接收到远程服务器推送过来的内容就会调用</div><div class="line">// 注意: 只有应用程序是打开状态(前台/后台), 才会调用该方法</div><div class="line">/// 如果应用程序是关闭状态会调用didFinishLaunchingWithOptions</div><div class="line">- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo</div><div class="line">&#123;</div><div class="line">    /*</div><div class="line">     如果应用程序在后台 , 只有用户点击了通知之后才会调用</div><div class="line">     如果应用程序在前台, 会直接调用该方法</div><div class="line">     即便应用程序关闭也可以接收到远程通知</div><div class="line">     */</div><div class="line">    NSLog(@&quot;%@&quot;, userInfo);</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<hr>
<p>(2) 在iOS7以后(包括7.0)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">	//接收到远程服务器推送过来的内容就会调用</div><div class="line">// ios7以后用这个处理后台任务接收到得远程通知</div><div class="line">- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo fetchCompletionHandler:(void (^)(UIBackgroundFetchResult))completionHandler</div><div class="line">&#123;</div><div class="line">    /*</div><div class="line">     远程消息数据格式：</div><div class="line">     &#123;&quot;aps&quot; : &#123;&quot;content-available&quot; : 1&#125;,&quot;content-id&quot; : 42&#125; </div><div class="line">     */</div><div class="line">    NSLog(@&quot;%s&quot;,__func__);</div><div class="line">    NSLog(@&quot;%@&quot;, userInfo);</div><div class="line"></div><div class="line">	NSNumber *contentid =  userInfo[@&quot;content-id&quot;];</div><div class="line">    if (contentid) &#123;</div><div class="line">        UILabel *label = [[UILabel alloc] init];</div><div class="line">        label.frame = CGRectMake(0, 250, 200, 200);</div><div class="line">        label.numberOfLines = 0;</div><div class="line">        label.textColor = [UIColor whiteColor];</div><div class="line">        label.text = [NSString stringWithFormat:@&quot;%@&quot;, contentid];</div><div class="line">        label.font = [UIFont systemFontOfSize:30];</div><div class="line">        label.backgroundColor = [UIColor grayColor];</div><div class="line">        [self.window.rootViewController.view addSubview:label];</div><div class="line">        //注意: 在此方法中一定要调用这个调用block, 告诉系统是否处理成功.</div><div class="line">        // 以便于系统在后台更新UI等操作</div><div class="line">        /*</div><div class="line">        执行completionHandler有两个目的</div><div class="line">        1&gt; 系统会估量App消耗的电量，并根据传递的UIBackgroundFetchResult 参数记录新数据是否可用</div><div class="line">        2&gt; 调用完成的处理代码时，应用的界面缩略图会自动更新 </div><div class="line">         注意：接收到远程通知到执行完网络请求之间的时间不能超过30秒</div><div class="line">         </div><div class="line">         UIBackgroundFetchResultNewData, 成功接收到数据</div><div class="line">         UIBackgroundFetchResultNoData, 没有;接收到数据</div><div class="line">         UIBackgroundFetchResultFailed 接收失败</div><div class="line">         */</div><div class="line">        completionHandler(UIBackgroundFetchResultNewData);</div><div class="line">    &#125;else</div><div class="line">    &#123;</div><div class="line">        completionHandler(UIBackgroundFetchResultFailed);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>在应用程序还没打开时<br>接收到apps服务器发过来数据，点击点击通知之后，会调用<strong>didFinishLanuchingWithOptions</strong>方法,从<strong>launchOption</strong>字典中取出UIApplicationLaunchOptionsRemoteNotificationKey对应的userInfo</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123;</div><div class="line">    </div><div class="line">    /*</div><div class="line">    注册通知代码</div><div class="line">    */</div><div class="line">    </div><div class="line">    // 1.取出数据</div><div class="line">    NSDictionary *userInfo = launchOptions[UIApplicationLaunchOptionsRemoteNotificationKey];</div><div class="line">    </div><div class="line">    if (userInfo) &#123;</div><div class="line">        //code</div><div class="line">    &#125;</div><div class="line">    return YES;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpeg"
               alt="超CniceToUpp" />
          <p class="site-author-name" itemprop="name">超CniceToUpp</p>
          <p class="site-description motion-element" itemprop="description">see you again</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">10</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/CNiceToUpp" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">超CniceToUpp</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'cnicetoupp';
      var disqus_identifier = 'index.html';

      var disqus_title = "";


      function run_disqus_script(disqus_script) {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');

      

    </script>
  





  
  

  

  

  

  

  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.0"></script>



</body>
</html>
